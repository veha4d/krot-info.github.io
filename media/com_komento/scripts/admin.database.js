Komento.module("admin.database",function(e){var t=this;Komento.require().language("COM_KOMENTO_SETTINGS_DATABASE_POPULATE_DEPTH_STATUS_UPDATING","COM_KOMENTO_SETTINGS_DATABASE_POPULATE_DEPTH_STATUS_COMPLETED","COM_KOMENTO_SETTINGS_DATABASE_POPULATE_DEPTH_STATUS_DONE").done(function(e){Komento.Controller("Database.DepthMaintenance",{defaultOptions:{"{start}":".start","{status}":".status","{total}":".total","{count}":".count","{statusWrapper}":".statusWrapper","{totalWrapper}":".totalWrapper","{countWrapper}":".countWrapper"}},function(t){return{init:function(){t.counter=0},"{start} click":function(n){n.enabled()&&(n.disabled(!0),t.statusWrapper().show(),t.totalWrapper().show(),t.countWrapper().show(),t.status().html('<img src="'+Komento.options.spinner+'" />'+e.language("COM_KOMENTO_SETTINGS_DATABASE_POPULATE_DEPTH_STATUS_UPDATING")),t.totalArticle(0),t.countArticle(0),Komento.ajax("admin.views.system.getArticleStatistics").done(function(e){t.totalArticle(e.length),t.articles=e,t.populateDepth()}).fail(function(){t.status().html(e.language("COM_KOMENTO_SETTINGS_DATABASE_POPULATE_DEPTH_STATUS_ERROR"))}))},populateDepth:function(){var n=t.articles[t.counter];if(n===undefined){t.populateComplete();return}Komento.ajax("admin.views.system.populateDepth",{component:n.component,cid:n.cid}).done(function(e){t.counter++,t.countArticle(parseInt(t.countArticle())+1),t.populateDepth()}).fail(function(){t.status().html(e.language("COM_KOMENTO_SETTINGS_DATABASE_POPULATE_DEPTH_STATUS_ERROR"))})},totalArticle:function(e){return e===undefined?t.total().html():t.total().html(e)},countArticle:function(e){return e===undefined?t.count().html():t.count().html(e)},populateComplete:function(){t.status().html(e.language("COM_KOMENTO_SETTINGS_DATABASE_POPULATE_DEPTH_STATUS_COMPLETED")),t.start().enabled(!0)}}}),t.resolve()})});